/* CSS3 Finalize - v1.2 - 2013-03-13 - Grid Layout Polyfill
* https://github.com/codler/Grid-Layout-Polyfill
* Copyright (c) 2013 Han Lin Yap http://yap.nu; http://creativecommons.org/licenses/by-sa/3.0/ */
(function(){var e;var d=function(){};var b=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];var c=b.length;var a=(window.console=window.console||{});while(c--){e=b[c];if(!a[e]){a[e]=d}}}());if(!Array.prototype.reduce){Array.prototype.reduce=function(b){if(this==null){throw new TypeError("can't convert "+this+" to object")}var f=Object(this);var a=f.length>>>0;if(typeof b!="function"){throw new TypeError(b+" is not a function")}if(a===0&&arguments.length<2){throw new TypeError("reduce of empty array with no initial value")}var e=0;var d;if(arguments.length>1){d=arguments[1]}else{var c=false;while((!c)&&(e<a)){c=e in f;if(c){d=f[e]}e++}if(!c){throw new TypeError("reduce of empty array with no initial value")}}while(e<a){if(e in f){d=b.call(undefined,d,f[e],e,f)}e++}return d}}function cssTextToObj(h){var c=h.split(/({[^{}]*})/);if(c[c.length-1].indexOf("}")==-1){c.pop()}var d=[];var a=false;var j;var f=0;var g;var e=0;while(e<c.length){if(e%2===0){var b=$.trim(c[e]);if(a){if(b.indexOf("}")!=-1){b=b.substr(1);c[e]=b;g=c.splice(f,e-f);g.shift();g.unshift(j[1]);d[d.length-1].attributes=cssTextToObj(g.join(""));a=false;e=f;continue}}else{if(b.indexOf("{")!=-1){j=b.split("{");b=$.trim(j[0]);a=true;f=e}if(b!==""){d.push({selector:b})}}}else{if(!a){d[d.length-1].attributes=cssTextAttributeToObj(c[e].substr(1,c[e].length-2))}}e++}return d}function cssTextAttributeToObj(c){var b;c=c.replace(/url\(([^)]+)\)/g,function(d){return d.replace(/;/g,"[cssFinalize]")});b=c.split(/(:[^;]*;?)/);b.pop();var a={};$.map(b,function(e,d){if(d%2==1){a[$.trim(b[d-1])]=$.trim(e.substr(1).replace(";","").replace(/url\(([^)]+)\)/g,function(f){return f.replace(/\[cssFinalize\]/g,";")}))}});return a}jQuery(function(h){if(document.createElement("div").style.msGridRowAlign===""){return false}var c=/(^|\s)(?:\w+)/g;var b=/\.[\w\d_-]+/g;var a=/#[\w\d_-]+/g;var m=function(p){var r=p.match(c);var t=r?r.length:0;r=p.match(b);var s=r?r.length:0;r=p.match(a);var q=r?r.length:0;return t+10*s+100*q};console.clear();var o=h("style").map(function(){return h(this).html()}).get().join("");var i=cssTextToObj(o);console.log(i);var g=n(i);console.log(g);function n(q){var p=[];h.each(q,function(r,s){if(s.attributes){if(s.attributes.display=="-ms-grid"){p.push({selector:s.selector,attributes:s.attributes,tracks:f(s.attributes)})}}});return p}function f(q){var s=q["-ms-grid-columns"].split(" "),r=q["-ms-grid-rows"].split(" ");var p=[];h.each(r,function(t,u){p[t]=[];h.each(s,function(w,v){p[t][w]={x:v,y:u}})});return p}h.each(g,function(r,s){var p=e(s.tracks,1,1,s.tracks.length,s.tracks[0].length);h(s.selector).css({position:"relative","box-sizing":"border-box",width:(s.attributes.display=="-ms-grid")?"100%":p.x,height:p.y});l(h(s.selector).outerWidth(),s.tracks);console.log(h(s.selector).outerWidth());console.log(h(s.selector).outerHeight());console.log(s.tracks);h(s.selector).children().css({"box-sizing":"border-box",position:"absolute",top:0,left:0,width:s.tracks[0][0].x,height:s.tracks[0][0].y}).each(function(w,y){var u=h(this);var v=d(u);v.sort(function(B,A){B=m(B);A=m(A);if(B<A){return -1}else{if(B>A){return 1}else{return 0}}});console.log(v);var t=k(i,v.pop());if(!t){return true}var z=t["-ms-grid-row"]||1;var x=t["-ms-grid-column"]||1;s.tracks[z-1][x-1].item=u});h(s.selector).children().css({"box-sizing":"border-box",position:"absolute",top:0,left:0,width:s.tracks[0][0].x,height:s.tracks[0][0].y}).each(function(w,x){var t=h(this);var A=d(t);A.sort(function(F,E){F=m(F);E=m(E);if(F<E){return -1}else{if(F>E){return 1}else{return 0}}});console.log(A);var v=k(i,A.pop());if(!v){return true}var D=v["-ms-grid-row"]||1;var u=v["-ms-grid-column"]||1;var B=v["-ms-grid-column-span"]||1;var y=v["-ms-grid-row-span"]||1;var C=e(s.tracks,D,u,y,B);var z=e(s.tracks,1,1,D-1,u-1);console.log(D,u,B,y);console.log(C);console.log(z);h(this).css({width:C.x,})});var q=j(h(s.selector).outerHeight(),s.tracks);h(s.selector).css({height:q});h(s.selector).children().each(function(w,x){var t=h(this);var A=d(t);A.sort(function(F,E){F=m(F);E=m(E);if(F<E){return -1}else{if(F>E){return 1}else{return 0}}});console.log(A);var v=k(i,A.pop());if(!v){return true}var D=v["-ms-grid-row"]||1;var u=v["-ms-grid-column"]||1;var B=v["-ms-grid-column-span"]||1;var y=v["-ms-grid-row-span"]||1;var C=e(s.tracks,D,u,y,B);var z=e(s.tracks,1,1,D-1,u-1);console.log(D,u,B,y);console.log(C);console.log(z);h(this).css({top:z.y,left:z.x,width:C.x,height:C.y})})});function l(s,q){for(var u=0;u<q.length;u++){var v=[];var t=s;for(var w=0;w<q[u].length;w++){if(q[u][w].x.indexOf("fr")!==-1){v.push(parseFloat(q[u][w].x))}else{if(q[u][w].x.indexOf("px")!==-1){t-=parseFloat(q[u][w].x)}}}var p=v.reduce(function(x,r){return parseInt(x,10)+parseInt(r,10)},0);for(var w=0;w<q[u].length;w++){if(q[u][w].x.indexOf("fr")!==-1){q[u][w].x=""+t/(p/parseFloat(q[u][w].x))}}}}function j(y,u){var t=y;var s=false;for(var w=0;w<u[0].length;w++){var q=[];var x=y;for(var p=0;p<u.length;p++){if(u[p][w].y.indexOf("fr")!==-1){q.push(parseFloat(u[p][w].y));if(u[p][w].item){u[p][w].item.height("auto");x+=u[p][w].item.outerHeight(true);if(!s){t+=u[p][w].item.outerHeight(true);s=true}}}else{if(u[p][w].y.indexOf("px")!==-1){console.log(u[p][w].y);x-=parseFloat(u[p][w].y)}}}var v=q.reduce(function(z,r){return parseInt(z,10)+parseInt(r,10)},0);for(var p=0;p<u.length;p++){if(u[p][w].y.indexOf("fr")!==-1){console.log(x,v,parseFloat(u[p][w].y));u[p][w].y=""+x/(v/parseFloat(u[p][w].y))}}}return t}function k(r,p){var q;h.each(r,function(s,t){if(t.selector==p){q=t.attributes;return false}});return q}function e(p,w,t,s,q){w--;t--;var v={x:0,y:0};for(var u=0;u<s;u++){if(p[w+u][t].y.indexOf("fr")===-1){v.y+=parseFloat(p[w+u][t].y)}}for(var x=0;x<q;x++){if(p[w][t+x].x.indexOf("fr")===-1){v.x+=parseFloat(p[w][t+x].x)}}return v}function d(s){var r=[];for(var p=0;p<document.styleSheets.length;p++){var u=document.styleSheets[p].cssRules;for(var q=0;q<u.length;q++){try{if(s.is(u[q].selectorText)){r.push(u[q].selectorText)}}catch(t){}}}return r}});